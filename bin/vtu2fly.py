#!/usr/bin/python3

"""
this converts a VTU file generated by CSMP into an escript fly file

THINGS TO DO:
    - use Rock type ID
    - use the node and element ID 
"""
import argparse, sys, os
from os.path import splitext
import importlib, os, sys
sys.path.append(os.path.join(os.path.dirname(os.path.realpath(__file__)), "lib"))
from convert import  VTK2FLY


parser = argparse.ArgumentParser(description='convert an vtk file into a fly file')
parser.add_argument('file_name', metavar='vtk_fn', type=str,
                   help='vtk file with unstructured grid information')
parser.add_argument('-f', '--fly', dest='fly_name', metavar='fly_fn', type=str, default=None,
                   help='output fly file name. If not vtk_fn with new extension .fly is used.')
parser.add_argument('--flipyz', '-zy',  dest='flipyz', action='store_true', default=False, help="flips y and z coordinate")

args = parser.parse_args()

file_name=args.file_name
if not args.fly_name:
    fn, ext=splitext(file_name)
    fly_name=fn+".fly"
else:
   fly_name=args.fly_name

print("input vtk file = "+file_name)
print("output fly file = "+fly_name)

converter=VTK2FLY().setVTKFileName(file_name).setFLYFileName(fly_name).setFlipYZ(args.flipyz)
converter.convertVTU()
